<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>19 Score expressions</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html,2,frames,index=3,info --> 
<meta name="src" content="OSCMsg.tex"> 
<link rel="stylesheet" type="text/css" href="OSCMsg.css"> 
</head><body 
>
<!--l. 3--><div class="crosslinks"><p class="noindent">[<a 
href="OSCMsgch21.html" >next</a>] [<a 
href="OSCMsgch18.html" >prev</a>] [<a 
href="OSCMsgch18.html#tailOSCMsgch18.html" >prev-tail</a>] [<a 
href="OSCMsgch18.html#tailOSCMsgch19.html">tail</a>] [<a 
href="OSCMsg3.html#OSCMsgch20.html" >up</a>] </p></div>
<h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;19</span><br /><a 
 id="x24-14400019"></a>Score expressions</h2>
<!--l. 6--><p class="noindent" ><span 
class="ptmri8t-">Score expressions </span>allows to defines score objects (<span 
class="pcrr8tn-">gmn </span>or <span 
class="pcrr8tn-">pianoroll</span>) by dynamically combine various resources
using a formal expression. To define such object one should use the basic <span 
class="pcrr8tn-">set </span>messages using a score expressions as
arguments:
<!--l. 8--><p class="noindent" ><span 
class="ptmbc8t-">E<span 
class="small-caps">X</span><span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">P</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span> </span><br 
class="newline" />The following example defines a <span 
class="pcrr8tn-">gmn </span>and a <span 
class="pcrr8tn-">pianoroll </span>object using score expressions, the meaning of the
expression is explained further.
<div class="center" 
>
<!--l. 11--><p class="noindent" >
<div 
class="colorbox" id="colorbox132"> <div class="minipage"><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn expr(seq [a] [b]); </span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/pianoroll set pianoroll expr(score);</span></div></div>
</div>
<h3 class="sectionHead"><span class="titlemark">19.1    </span> <a 
 id="x24-14500019.1"></a>General Syntax</h3>
<!--l. 16--><p class="noindent" >A score expression always starts with <span 
class="pcrr8tn-">expr( </span>and ends with <span 
class="pcrr8tn-">)</span>, then 2 syntaxes are handled:
<a 
 id="dx24-145001"></a>
<dl class="list1"><dt class="list">
</dt><dd 
class="list">
<!--l. 27--><p class="noindent" ><div class="minipage"><span 
class="ptmri8t-">EvaluableExpression</span> <img 
src="OSCMsg146x.png" alt="PICT" >
</div></dd></dl>
     <ul class="itemize1">
     <li class="itemize"><span 
class="ptmb8t-">1</span>: Define an expression as an operation combining two scores. <span 
class="pcrr8tn-">operator </span>is the name of the operation
     used to combine them (see Section&#x00A0;<a 
href="#x24-14600019.2">19.2<!--tex4ht:ref: operators --></a> for operators list), and <span 
class="pcrr8tn-">score </span>are the arguments passed to
     the operator (see Section&#x00A0;<a 
href="#x24-14700019.3">19.3<!--tex4ht:ref: arguments --></a> for arguments specification).
     </li>
     <li class="itemize"><span 
class="ptmb8t-">2</span>:  Define  on  expression  using  a  single  score.  This  syntax  is  useful  when  defining  an  object  as  a
     dynamic copy of an other existing object or file.</li></ul>
<!--l. 33--><p class="noindent" >Each of these tokens can, of course, be separated by spaces, tabulations or carriage returns (allowing multiline
expression definition).
<!--l. 35--><p class="noindent" >When defining an object using a score expressions, INScore will parse it, construct an internal representation and
finally evaluate it, reducing the formal expressions to a valid GMN string.
<!--l. 37--><p class="noindent" ><span 
class="ptmbc8t-">E<span 
class="small-caps">X</span><span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">P</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span> </span><br 
class="newline" />Creating a guido object by sequencing two guido string
<div class="center" 
>
<!--l. 41--><p class="noindent" >
                                                                                 

                                                                                 
<div 
class="colorbox" id="colorbox133"> <div class="minipage">  <span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn expr( seq "[c d e]" "[f g h]");</span>
</div></div>
</div>
<!--l. 42--><p class="noindent" >is equivalent to
<div class="center" 
>
<!--l. 45--><p class="noindent" >
<div 
class="colorbox" id="colorbox134"> <div class="minipage">  <span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn "[c d e f g h]";</span>
</div></div>
</div>
<!--l. 47--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">19.2    </span> <a 
 id="x24-14600019.2"></a>Score Operators</h3>
<!--l. 49--><p class="noindent" >All the score operators of INScore make use of guido operators implemented in the GuidoAR library.
                                                                                 

                                                                                 
<!--l. 50--><p class="noindent" ><hr class="float"><div class="float" 
>
                                                                                 

                                                                                 
<div class="center" 
>
<!--l. 51--><p class="noindent" >
<div class="tabular"> <table id="TBL-17" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-17-1g"><col 
id="TBL-17-1"><col 
id="TBL-17-2"><col 
id="TBL-17-3"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-17-1-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-1-1"  
class="td11">operation</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-1-2"  
class="td11">arguments</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-1-3"  
class="td11">description                                                                                                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-17-2-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-2-1"  
class="td11">     seq</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-2-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-2-3"  
class="td11">puts the scores <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>and <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>in sequence                                                            </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-3-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-3-1"  
class="td11">     par</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-3-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-3-3"  
class="td11">puts the scores <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>and <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>in parallel                                                               </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-4-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-4-1"  
class="td11">     rpar</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-4-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-4-3"  
class="td11">puts the scores <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>and <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>in parallel, right aligned                                        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-5-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-5-1"  
class="td11">     top</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-5-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-5-3"  
class="td11">takes the <span 
class="zptmcmrm-">n </span>first voices of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>where <span 
class="zptmcmrm-">n </span>is <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>voices count                                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-6-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-6-1"  
class="td11">  bottom</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-6-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-6-3"  
class="td11">cut the <span 
class="zptmcmrm-">n </span>first voices of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>where <span 
class="zptmcmrm-">n </span>is <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>voices count                                   </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-17-7-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-7-1"  
class="td11"> head</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-7-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2 </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-7-3"  
class="td11">takes the head of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>up to <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>duration</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-8-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-8-1"  
class="td11">  evhead</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-8-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-8-3"  
class="td11">takes the <span 
class="zptmcmrm-">n </span>first events of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>where <span 
class="zptmcmrm-">n </span>is the event&#8217;s count of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2                </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-9-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-9-1"  
class="td11">     tail</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-9-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-9-3"  
class="td11">cut the beginning of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>up to the duration of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2                                 </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-10-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-10-1"  
class="td11">    evtail</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-10-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-10-3"  
class="td11">cut the <span 
class="zptmcmrm-">n </span>first events of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>where <span 
class="zptmcmrm-">n </span>is the event&#8217;s count of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2                  </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-11-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-11-1"  
class="td11"> transpose</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-11-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-11-3"  
class="td11">transposes <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>so its first note of its first voice match <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>one                          </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-12-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-12-1"  
class="td11"> duration</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-12-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-12-3"  
class="td11">stretches <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>to the duration of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2                                                   </span></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-13-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-13-1"  
class="td11">        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-13-2"  
class="td11">        </td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-13-3"  
class="td11">if not used carefully, this operator can output impossible to display rhythm</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-14-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-14-1"  
class="td11">    pitch</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-14-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-14-3"  
class="td11">applies the pitches of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>to <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>in a loop                                                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-17-15-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-15-1"  
class="td11">  rhythm</td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-15-2"  
class="td11"><span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1</span><span 
class="zptmcmrm-">&#x00A0;s</span><span 
class="zptmcmr-">2      </span></td><td  style="white-space:nowrap; text-align:left;" id="TBL-17-15-3"  
class="td11">applies the rhythm of <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">1 </span>to <span 
class="zptmcmrm-">s</span><span 
class="zptmcmr-">2 </span>in a loop                                                         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-17-16-"><td  style="white-space:nowrap; text-align:right;" id="TBL-17-16-1"  
class="td11">        </td></tr></table></div></div>
                                                                                 

                                                                                 
</div><hr class="endfloat" />
<h3 class="sectionHead"><span class="titlemark">19.3    </span> <a 
 id="x24-14700019.3"></a>Score Arguments</h3>
<!--l. 79--><p class="noindent" >The syntax for arguments is quite permissive and various resources can be used as arguments for score expressions.
In any case, when evaluating the expression, all the arguments will be reduce to GMN string so they can then be
processed by the operators.
<a 
 id="dx24-147001"></a>
<dl class="list1"><dt class="list">
</dt><dd 
class="list">
<!--l. 90--><p class="noindent" ><div class="minipage"><span 
class="ptmri8t-">Argument</span> <img 
src="OSCMsg147x.png" alt="PICT" >
</div></dd></dl>
<!--l. 92--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x24-14800019.3"></a>Arguments specification</h5>
     <ul class="itemize1">
     <li class="itemize"><span 
class="pcrr8tn-">GmnCode </span>are not evaluated, passed as they are to operators. Both GMN and MusicXML string are
     supported.
     </li>
     <li class="itemize"><span 
class="pcrr8tn-">filepath</span>: on evaluation INScore read all the content of the file. Again, both GMN and MusicXML
     are supported. <span 
class="pcrr8tn-">filepath </span>handle absolute or relative path (from the scene rootPath) as well as url.
     </li>
     <li class="itemize"><span 
class="pcrr8tn-">ScoreObject</span>: Gmn code can be retreive from existing score objects (<span 
class="pcrr8tn-">gmn </span>or <span 
class="pcrr8tn-">pianoroll</span>) simply
     refering to them using their identifier (using absolute or relative path).
     </li>
     <li class="itemize"><span 
class="pcrr8tn-">EvaluableExpression</span>: an expression can also be used as an argument, thus simple operator can
     be  combined  together  to  create  more  complex  ones.  In  that  case  the  <span 
class="pcrr8tn-">expr </span>token  can  be  omitted:
     parenthesis are sufficient.</li></ul>
<!--l. 101--><p class="noindent" >
<h5 class="subsubsectionHead"><a 
 id="x24-14900019.3"></a>Arguments prefix</h5>
                                                                                 

                                                                                 
     <ul class="itemize1">
     <li class="itemize"><span 
class="pcrr8tn-">&amp;</span>: When triggering the reevaluation of an expression (see Section&#x00A0;<a 
href="#x24-15000019.4">19.4<!--tex4ht:ref: exprCmd --></a>) only the arguments prefixed
     with <span 
class="pcrr8tn-">&amp; </span>are updated.
     </li>
     <li class="itemize"><span 
class="pcrr8c-">~</span>: before the first evaluation of a score expression, any <span 
class="pcrr8tn-">ScoreObjects </span>prefixed with a <span 
class="pcrr8c-">~ </span>shall be
     replaced by their own expression. In other words, score expressions containing <span 
class="pcrr8c-">~ </span>arguments will be
     expended with existing score expressions. This mechanism allows to compose not only scores and
     score expressions together.
     </li></ul>
<!--l. 111--><p class="noindent" ><span 
class="ptmbc8t-">E<span 
class="small-caps">X</span><span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">P</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span> </span><br 
class="newline" />Defining <span 
class="pcrr8tn-">/ITL/scene/score </span>as a copy of <span 
class="pcrr8tn-">/ITL/scene/simpleScore </span>duplicated 4 times.
<div class="center" 
>
<!--l. 118--><p class="noindent" >
<div 
class="colorbox" id="colorbox135"> <div class="minipage"><span 
class="pcrr8tn-x-x-90">/ITL/scene/simpleScore set gmn "[e {c,g} |]";</span><br 
class="newline" /><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn expr( &amp;simpleScore );</span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn expr( seq </span><span 
class="pcrr8c-x-x-90">~</span><span 
class="pcrr8tn-x-x-90">score </span><span 
class="pcrr8c-x-x-90">~</span><span 
class="pcrr8tn-x-x-90">score);</span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn expr( par </span><span 
class="pcrr8c-x-x-90">~</span><span 
class="pcrr8tn-x-x-90">score </span><span 
class="pcrr8c-x-x-90">~</span><span 
class="pcrr8tn-x-x-90">score);</span><br 
class="newline" /></div></div>
</div>
<!--l. 119--><p class="noindent" ><span 
class="pcrr8tn-">/ITL/scene/score </span>should look like:<br 
class="newline" />
<div class="center" 
>
<!--l. 120--><p class="noindent" >
<!--l. 121--><p class="noindent" ><img 
src="OSCMsg148x.png" alt="PIC" class="graphics" width="133" height="68" ><!--tex4ht:graphics  
name="OSCMsg148x.png" src="imgs/seqparEnhanced.ps"  
--></div>
<!--l. 124--><p class="noindent" >Querying for the expanded expression of <span 
class="pcrr8tn-">/ITL/scene/score </span>(see Section&#x00A0;<a 
href="#x24-15000019.4">19.4<!--tex4ht:ref: exprCmd --></a>) should return:
                                                                                 

                                                                                 
<div class="verbatim" id="verbatim-1">
/ITL/scene/score&#x00A0;expr
&#x00A0;<br />&#x00A0;&#x00A0;expr(&#x00A0;par
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(&#x00A0;seq
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&amp;simpleScore
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&amp;simpleScore
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;)
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;(&#x00A0;seq
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&amp;simpleScore
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&amp;simpleScore
&#x00A0;<br />&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;&#x00A0;)
&#x00A0;<br />&#x00A0;&#x00A0;)
</div>
<!--l. 137--><p class="nopar" >
<!--l. 140--><p class="noindent" ><span 
class="ptmbc8t-">N<span 
class="small-caps">O</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span> <span 
class="small-caps">O</span><span 
class="small-caps">N</span> <span 
class="small-caps">A</span><span 
class="small-caps">R</span><span 
class="small-caps">G</span><span 
class="small-caps">U</span><span 
class="small-caps">M</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span><span 
class="small-caps">T</span><span 
class="small-caps">S</span> <span 
class="small-caps">Q</span><span 
class="small-caps">U</span><span 
class="small-caps">O</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span> </span><br 
class="newline" />Arguments using special characters (space, tabulation, parenthesis, braces...), should be simple or double quoted,
otherwise quotes can be omitted.
<!--l. 147--><p class="noindent" >
<h3 class="sectionHead"><span class="titlemark">19.4    </span> <a 
 id="x24-15000019.4"></a><span 
class="pcrr8tn-">expr </span>commands</h3>
<!--l. 150--><p class="noindent" >ITLObject defined using an evaluable expression gain access to these specific commands:
     <ul class="itemize1">
     <li class="itemize"><span 
class="pcrr8tn-">get expr</span>: return the expression used to define the object (before the expansion of <span 
class="pcrr8c-">~ </span>arguments).
     </li>
     <li class="itemize"><span 
class="pcrr8tn-">get exprTree</span>: return the expanded expression
     </li>
     <li class="itemize"><span 
class="pcrr8tn-">expr reeval</span>: re-evaluate the expression, updating only the value of arguments prefixed with <span 
class="pcrr8tn-">&amp;</span>.
     </li>
     <li class="itemize"><span 
class="pcrr8tn-">expr reset</span>: re-evaluate the expression, updating the value of all arguments.
     </li>
     <li class="itemize"><span 
class="pcrr8tn-">expr renew</span>: reapply the definition of the object (similar to send its <span 
class="pcrr8tn-">set </span>message again)</li></ul>
<!--l. 161--><p class="noindent" >Applied to an object which wasn&#8217;t defined by an evaluable expression, all this commands will cause a bad argument
error.
<!--l. 164--><p class="noindent" >The <span 
class="pcrr8tn-">renew </span>command reset the internal state of the evaluated variable, forcing the re-evaluation and update of every
arguments in the expression. Be aware that the track of copy evaluated arguments is lost after the first
evaluation, thus renewing an expression defined using copy evaluated arguments won&#8217;t update these
arguments to their targeted ITLObject expression. Though, static arguments added by the copy shall be
renewed.
<!--l. 168--><p class="noindent" >
                                                                                 

                                                                                 
<h3 class="sectionHead"><span class="titlemark">19.5    </span> <a 
 id="x24-15100019.5"></a>newData event</h3>
<!--l. 170--><p class="noindent" ><span 
class="pcrr8tn-">newData </span>is triggered by any object when its value change (generally because of a <span 
class="pcrr8tn-">set </span>message). Neither trying to
set an object to its actual value without changing its type, nor re-evaluating an object to its actual value will trigger
newData.
<!--l. 172--><p class="noindent" >Of course, the <span 
class="pcrr8tn-">newData </span>event can be used together with <span 
class="pcrr8tn-">reeval </span>to automatically update an object when the value of
an other changes.
<!--l. 174--><p class="noindent" ><span 
class="ptmbc8t-">E<span 
class="small-caps">X</span><span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">P</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span> </span><br 
class="newline" />Creating a copy of <span 
class="pcrr8tn-">score</span>, and automatise its update when <span 
class="pcrr8tn-">score </span>is changed
<div class="center" 
>
<!--l. 179--><p class="noindent" >
<div 
class="colorbox" id="colorbox136"> <div class="minipage"><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn "[c e]";</span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/copy set gmn expr(&amp;score);</span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/score watch newData (/ITL/scene/copy expr reeval);</span></div></div>
</div>
<!--l. 181--><p class="noindent" >To avoid infinite loop when using recursion, <span 
class="pcrr8tn-">newData </span>event is delayed of one event loop, meaning that, in the
previous example, during the event loop that follow <span 
class="pcrr8tn-">score</span>&#8217;s modification, <span 
class="pcrr8tn-">score </span>and <span 
class="pcrr8tn-">copy </span>are different (<span 
class="pcrr8tn-">copy </span>has
not been updated yet...).
<!--l. 183--><p class="noindent" ><span 
class="ptmbc8t-">N<span 
class="small-caps">O</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span> </span><br 
class="newline" /> Because newData event is delayed, if <span 
class="pcrr8tn-">score </span>experiences multiple modifications during the same event loop
(because multiple <span 
class="pcrr8tn-">set </span>messages have been sent together), only his final value will be accessible when
newData will be actually triggered, however the event will be sent as many times as <span 
class="pcrr8tn-">score </span>have been
modified.
<!--l. 186--><p class="noindent" ><span 
class="ptmbc8t-">N<span 
class="small-caps">O</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span> <span 
class="small-caps">W</span><span 
class="small-caps">H</span><span 
class="small-caps">E</span><span 
class="small-caps">N</span> <span 
class="small-caps">A</span><span 
class="small-caps">U</span><span 
class="small-caps">T</span><span 
class="small-caps">O</span><span 
class="small-caps">M</span><span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">I</span><span 
class="small-caps">S</span><span 
class="small-caps">I</span><span 
class="small-caps">N</span><span 
class="small-caps">G</span> <span 
class="small-caps">U</span><span 
class="small-caps">P</span><span 
class="small-caps">D</span><span 
class="small-caps">A</span><span 
class="small-caps">T</span><span 
class="small-caps">E</span></span><br 
class="newline" />For the reasons raised in the previous note, one should be very careful to delayed update when automatise <span 
class="pcrr8tn-">reeval</span>
with <span 
class="pcrr8tn-">newData</span>. Indeed, in some extreme case, executing a script one line after an other won&#8217;t have the same result as
executing the all script at once!!
<!--l. 191--><p class="noindent" ><span 
class="ptmbc8t-">E<span 
class="small-caps">X</span><span 
class="small-caps">A</span><span 
class="small-caps">M</span><span 
class="small-caps">P</span><span 
class="small-caps">L</span><span 
class="small-caps">E</span> </span><br 
class="newline" />Creating a "score buffer", storing every state adopted by <span 
class="pcrr8tn-">score</span>
<div class="center" 
>
<!--l. 202--><p class="noindent" >
<div 
class="colorbox" id="colorbox137"><div class="minipage"><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn "[c]";</span><br 
class="newline" /><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/buffer set gmn "[]";</span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/buffer set gmn expr(seq &amp;buffer (seq "[|]" &amp;score));</span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/score watch newData (/ITL/scene/buffer expr reeval);</span><br 
class="newline" /><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn "[e]";</span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn "[g]";</span><br 
class="newline" /><span 
class="pcrr8tn-x-x-90">/ITL/scene/score set gmn "[{c,e,g}]";</span></div></div>
</div>
<!--l. 203--><p class="noindent" >Won&#8217;t have the same result if run line by line, or the all script as once:
<!--l. 206--><p class="noindent" >Line by line:
<div class="center" 
>
                                                                                 

                                                                                 
<!--l. 207--><p class="noindent" >
<!--l. 208--><p class="noindent" ><img 
src="OSCMsg149x.png" alt="PIC" class="graphics" width="217" height="76" ><!--tex4ht:graphics  
name="OSCMsg149x.png" src="imgs/autoSingleLine.ps"  
--></div>
<!--l. 212--><p class="noindent" >All script at once:
<div class="center" 
>
<!--l. 213--><p class="noindent" >
<!--l. 214--><p class="noindent" ><img 
src="OSCMsg150x.png" alt="PIC" class="graphics" width="217" height="76" ><!--tex4ht:graphics  
name="OSCMsg150x.png" src="imgs/autoAllScript.ps"  
--></div>
<!--l. 219--><p class="noindent" >To avoid such undeterministic behaviour, one should, in this case, manually trigger <span 
class="pcrr8tn-">reeval </span>after each modification
of <span 
class="pcrr8tn-">score</span>.
                                                                                 

                                                                                 
<!--l. 3782--><div class="crosslinks"><p class="noindent">[<a 
href="OSCMsgch21.html" >next</a>] [<a 
href="OSCMsgch18.html" >prev</a>] [<a 
href="OSCMsgch18.html#tailOSCMsgch18.html" >prev-tail</a>] [<a 
href="OSCMsgch19.html" >front</a>] [<a 
href="OSCMsg3.html#OSCMsgch20.html" >up</a>] </p></div>
<!--l. 3782--><p class="noindent" ><a 
 id="tailOSCMsgch19.html"></a>  
</body></html> 
